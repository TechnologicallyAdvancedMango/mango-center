<!doctype html>
<html>
<head>
	<title>Physics Engine</title>
	<link rel="icon" type="image/png" href="phys-straight.png">
<style>
	body {
		background-color: white;
    
		margin: 0;
		padding: 0;
		overflow: hidden;

		font-family: Arial, sans-serif;
	}

	#canvas {
		background-color: #707070;
		border: 0px;

		position: fixed;
		top: 0;
		right: 0;
		
		width: calc(100vw - 150px);
		height: 100vh;
		
		margin: 0;
		padding: 0;
	}

	#propertyMenu {
		display:none;
		position:absolute;
		background:#222;
		color:#fff; 
		padding:10px;
		border-radius:5px;
		z-index: 1000;
	}

	#help {
		position: fixed;
		top: 10px;
		right: 10px;
		width: 30px;
		height: 30px;
		background-color: #20202060;
		color: white;
		font-size: 20px;
		text-align: center;
		line-height: 30px;
		border-radius: 15px;
		cursor: help;
		user-select: none;
		z-index: 1000;
	}
	#help:hover {
		background-color: #20202090;
	}

	[data-tooltip]:hover::after {
  		display: block;
  		position: absolute;
		text-align: left;
		right: 2px;
		width: max-content;
		max-width: 100vw;
		max-height: calc(100vh - 80px);
		white-space: pre-wrap;
  		content: attr(data-tooltip);
  		border: 1px solid black;
		border-radius: 5px;
  		background: #202020f0;
  		padding: 10px;
		margin: 0px;
		overflow: auto;
	}

	#pauseIcon {
		display: none;
		position: fixed;
		top: 5px;
		left: 180px;
		font-size: 100px;
		font-weight: bolder;
		color: rgba(255, 255, 255, 0.7);
		pointer-events: none;
		user-select: none;
		z-index: 1000;
	}

	#toolSidebar {
		position: fixed;
		left: 0;
		top: 0;
		width: 150px;
		height: 100vh;
		display: flex;
		flex-flow: column nowrap;
		align-items: stretch;
		justify-content: flex-start;
		background: #111111;
		color: white;
		padding: 10px;
		z-index: 2000;
		overflow: auto;
	}
	#toolSidebar button {
		width: calc(100% - 10px);
		min-height: 40px;
		background: #444;
		color: white;
		border: none;
		border-radius: 5px;
		padding: 6px;
		margin: 5px;
		font-size: 16px;
		cursor: pointer;
	}
	#toolSidebar button:hover  {
		background: #666;
	}
	#toolSidebar button:active {
		background: #3b3b3b;
	}

	#experimental {
		width: calc(100% - 15px);
		margin-top: auto;
		padding: 5px;
		margin-bottom: 15px;

		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		
		border: 2px solid rgb(112, 68, 68);
		border-radius: 5px;
		background: rgb(99, 39, 39);
	}
	#utility {
		width: calc(100% - 15px);
		padding: 5px;
		margin-bottom: 15px;

		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		
		border: 2px solid rgb(58, 58, 58);
		border-radius: 5px;
		background: rgb(39, 39, 39);
	}
	#creation {
		width: calc(100% - 15px);
		padding: 5px;
		margin-bottom: 15px;

		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		
		border: 2px solid rgb(50, 67, 50);
		border-radius: 5px;
		background: rgb(34, 48, 34);
	}
	#creation button {
		background: rgb(67, 95, 67);
	}
	#envSettings {
		display:none;
		position:absolute;
		top:50px;
		left:200px; 
		background:#222;
		color:#fff;
		padding:15px;
		border-radius:8px;
		z-index:3000;
	}
</style>
</head>
<body>
<canvas id="canvas"></canvas>
<div id="toolSidebar">
	<div id="utility">
		<p>Utility</p>
		<button onclick="setTool('none')">‚úã None</button>
		<button onclick="setTool('select')">üñ±Ô∏è Select
			<label for="selectFilter">Filter:</label>
			<select id="selectFilter">
				<option value="any">Any</option>
				<option value="circle">Circle</option>
				<option value="spring">Spring</option>
			</select>
		</button>
		<button onclick="setTool('move')">üîÄ Move</button>
		<button onclick="copySelected()">üìÑ Copy</button>
		<button onclick="setTool('paste')">üìã Paste</button>
		<button onclick="deleteSelected()">üóëÔ∏è Delete</button>
		<button onclick="showProperties()">‚öôÔ∏è Properties</button>

		<input type="file" onchange="loadGameState(this.files[0])" style="
		width: calc(100% - 10px);
		min-height: 40px;
		background: #444;
		color: white;
		border: none;
		border-radius: 5px;
		padding: 6px;
		margin: 5px;
		font-size: 16px;
		cursor: pointer;">
		<button onclick="saveGameState()">üíæ Save</button>
		<button onclick="openEnvSettings()">Environment Settings</button>
	</div>

  	<div id="creation">
		<p>Creation</p>
		<button onclick="setTool('spring')">‚Äî Spring</button>
		<button onclick="setTool('circle')">‚óè Circle</button>
		<button onclick="setTool('softbody')">‚ñ¶ Softbody</button>
	</div>

	<div id="experimental">
		<p>Experimental</p>
		<button onclick="setTool('pan')">üé¶ Pan</button>
		<button onclick="panX = 0; panY = 0; draw();">Reset View</button>
	</div>
</div>
<div id="propertyMenu"></div>
<div id="envSettings">
	<h3>Environment Settings</h3>

	<label>Adaptive frameMultiplier:
    	<input type="checkbox" id="frameMultiplierCheckbox" value="yes">
  	</label><br><br>

	<label>Target FPS:
		<input type="number" id="targetFPSInput" value="60" min="1" max="240">
  	</label><br><br>
  
  	<label>Gravity:
    	<input type="number" id="gravityInput" value="1000" step="10">
  	</label><br><br>

  	<label>Simulation Speed:
    	<input type="number" id="speedInput" value="1.0" step="0.01">
  	</label><br><br>
  
  	<label>Air Resistance:
    	<input type="number" id="airInput" value="0.01" step="0.001">
  	</label><br><br>
  
  <button onclick="applyEnvSettings()">Apply</button>
  <button onclick="closeEnvSettings()">Close</button>
</div>
<div id="pauseIcon">| |</div>
<div id="help" data-tooltip=
"Controls:

Tools:
	None: Drag circles around with left click
	Select: Select one or more parts
		Filter: Filters what type of parts you can select
	Move: Drag to move the selected parts around
	Paste: Paste parts from the clipboard as many times as you want
	Spring: Drag between two circles to create a spring between those circles
	Circle: Creates a circle where you click
	Softbody: Creates a 10x10 grid of interconnected springs and circles

Buttons:
	Copy: Copies the selected parts to the clipboard
	Delete: Deletes the selected parts
	Properties: Opens a properties menu for the selected parts
		You can only edit the properties of the same type of part at the same time.
		Click the X in the top right or press enter in a text field to apply properties.
		Leave a field empty when selecting multiple parts to leave that property unchanged.

Environment Settings:
	Adaptive frameMultiplier: Adjust physics calculations to minimize lag
		Default: On
		Reduces collision accuracy when laggy to keep rendering smooth.
	Target FPS: The target FPS for the Adaptive frameMultiplier
		Default: 60
		Springs freak out when this is adjusted while running.
	Gravity: Changes the gravity value of the simulation
		Default: 2000
	Simulation Speed: Changes the speed of the simulation
		Default: 1
	Air Resistance: Changes the effect of air resistance (drag) on objects in the simulation
		Defualt: 0.01

Experimental/Broken:
	Pan: Pan the camera
	Reset View: Resets the camera's position
">?</div>
<script src="physicsEngine.js"></script>
</body>
</html>
