<!doctype HTML>
<html>
<head>
  <title>HTML5 Canvas 3D Renderer</title>
  <style>
    canvas {
      border: 1px solid black;
    }
  </style>
</head>
<body>
<canvas id="c" width="800" height="450"></canvas>

<script type="text/javascript">
function Dot(V, W)
{
	var D = 0;
	for (var i = 0; i < 3; i++) D += V[i] * W[i];
	return D;
}

function Cross(V, W)
{
	return [ V[1] * W[2] - V[2] * W[1], V[2] * W[0] - V[0] * W[2], V[0] * W[1] - V[1] * W[2] ];
}

var Camera =
{
	"p": [ 0, 0, 1 ],
	"c": [ 0, 0, -1 ],
	"u": [ 0, 1, 0 ],
	"d0": 1
};
Camera.g = Cross(Camera.c, Camera.u);

function ScreenToCanvasCoordinates(ScreenX, ScreenY)
{
	return { "X": 400 + PixelsPerUnitLength * ScreenX, "Y": 225 - PixelsPerUnitLength * ScreenY };
}

var PixelsPerUnitLength = 500;

var Context = document.getElementById("c").getContext("2d");
function Draw()
{
	Context.clearRect(0, 0, Context.canvas.width, Context.canvas.height);
	Points.sort(function(A, B) { return A.r[2] - B.r[2]; });
	Points.forEach
	(
		function(P)
		{
			var Offset = [ P.r[0] - Camera.p[0], P.r[1] - Camera.p[1], P.r[2] - Camera.p[2] ];
			var d = Dot(Offset, Camera.c);
			if (d <= 0) return;
			var ScaleFactor = Camera.d0 / d;
			var ScreenX = ScaleFactor * Dot(Offset, Camera.g);
			var ScreenY = ScaleFactor * Dot(Offset, Camera.u);

			var Coords = ScreenToCanvasCoordinates(ScreenX, ScreenY);
			Context.fillStyle = P.Color;
			Context.beginPath();
			Context.arc(Coords.X, Coords.Y, PixelsPerUnitLength * ScaleFactor * 0.1, 0, 2 * Math.PI);
			Context.fill();
		}
	);
}


Draw();
</script>
</body>
</html>
